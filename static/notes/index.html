<!DOCTYPE html>
    <html lang = 'en'>
    <!-- Matthew Senese, Matthew O'Malley, Jon Rayo -->

    <head>
        <meta charset = 'UTF-8'>
        <title>Noteify</title>
        <link rel = "stylesheet" href = "index.css">
        <link rel="icon" type="image/x-icon" href="./icons/fav.PNG">
        <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database.js"></script>
        <meta name = "viewport" content = "width = device-width, initial-scale = 1.0">

    </head>

    <input style = "position: absolute; top: 10px; left: 10px; width: auto;
    font-family: fire; background-color: transparent; border: none" 
    class = "loggedIn" type = "text" id = "loggedInAs" readonly size = "40">

    <script>

        // Function to show elements upon click for note creation
        async function showEls() {
            
            // request to the server to check if user is logged in
            const fetchString = "/islogged?"
            const response = await fetch(fetchString)
            const responseText = await response.text()
            
            // if user is not logged in, show the note display elements
            if (responseText != "NoLog") {
                document.getElementById('titleOutput').className = "show";
                document.getElementById('noteOutput').className = "show";
                document.getElementById('editNoteID').className = "show";
                document.getElementById('deleteNoteID').className = "show"; 
            } else {
                // redirect to login page
                location.href = 'https://noteify.azurewebsites.net/login/';
            }
        }
    </script>

    <script>

        window.onload = function() {
        welcMsg(); };

        async function welcMsg() {

            const fetchString = "/islogged?"
            const response = await fetch(fetchString)
            const responseText = await response.text()

            document.getElementById('loggedInAs').value = "Welcome, " + responseText
            document.getElementById('loggedInAs').className = "hideIt";

            if (responseText.length > 6) {
                document.getElementById('loggedInAs').className = "show";
            }
        }

    </script>

    <!-- Navigation Bar -->
    <ul class = "navbar">
        <li><a href="https://noteify.azurewebsites.net/"><img style = "padding-right: 5px;" src = "./icons/home.png" 
            alt = "homeIcon" class = "icon"><span style = "font-size: 14px">Home</span></a></li>
        <li><a href="https://noteify.azurewebsites.net/login"><img style = "padding-right: 5px;" src = "./icons/login.png" 
            alt = "loginIcon" class = "icon"><span style = "font-size: 14px">Login</span></a></li></a></li>
        <li><a href="https://noteify.azurewebsites.net/logout"><img style = "padding-right: 5px;" src = "./icons/logout.png" 
            alt = "logoutIcon" class = "icon"><span style = "font-size: 14px">Logout</span></a></li></a></li>
        <li><a href="https://noteify.azurewebsites.net/noteify"><img style = "padding-right: 5px;" src = "./icons/noteify.png" 
            alt = "noteifyIcon" class = "icon"><span style = "font-size: 14px">Noteify</span></a></li></a></li>
        <li style = "background-color: rgb(196, 196, 196)"><a href="https://noteify.azurewebsites.net/notes"><img style = "padding-right: 5px;" src = "./icons/view.png" 
            alt = "viewIcon" class = "icon"><span style = "font-size: 14px">View</span></a></li></a></li>
        <li class = "hideIt"><a href="https://noteify.azurewebsites.net/projectProposal"><img style = "padding-right: 5px;" src  = "./icons/about.png" 
            alt = "aboutIcon" class = "icon"><span style = "font-size: 14px">About</span></a></li></a></li>
    </ul>

    <!-- Header -->
    <body>
        <h1 class = "toptitle">Noteify</h1>
        <p class = "topsubtitle">Start Taking Note</p>

    <div class = "mainbody">
        <h2 style = "margin-top: 0; font-family: lato;">My Notes</h2>
        <p class = "bodytext">Welcome to the view page! Here, you can view, edit, and delete all your previously saved notes!
            Click "View" to begin.
        </p>


    <!-- location bar at the bottom of the page -->
    <div style = "position: relative; text-align: center">
        <a href = "https://noteify.azurewebsites.net/noteify">
        <p class = "bottomnav"><span style = "border-radius: 10px; padding: 1px; border-width: 1px;
        background-color: rgb(233, 233, 233); border-style: solid;">&nbsp;www.noteify.com/notes&nbsp;</span></p></a>
    </div>

    <button class = "createButton" name = "showText" type = "button" onclick = "showEls()">View</button> <br><br>

    <!-- Textbox for Title line -->
    <textarea  style = "line-height: 10px; resize: none" class = "textBox" id = "titleOutput" name = "titleInput"
    rows = "1" cols = "35" wrap = "physical"></textarea><br><br>

    <!-- Textbox for user input -->
    <textarea class = "textBox" id = "noteOutput" name = "textInput"
    rows = "10" cols = "70" wrap = "physical"></textarea>

    <!-- Div styling for options buttons -->
    <div class = "buttonRow">

        <!-- Clear button for textbox --> <br>
        <button style = "border: 2px solid black; padding-top: 4px; border-radius: 10px; margin: 5px; cursor: pointer;
        padding-bottom: 4px; padding-left: 6px; padding-right: 6px;" class = "hideIt" 
        id = "editNoteID"  type = "button" onclick = "editNote()">Edit Note</button>

        <!-- Submit button for note -->
        <button style = "border: 2px solid black; padding-top: 4px; border-radius: 10px; margin: 5px; cursor: pointer;
        padding-bottom: 4px; padding-left: 6px; padding-right: 6px;" class = "hideIt"
        id = "deleteNoteID"  type = "button" onclick = "deleteNote()">Delete Note</button>
    </div>

    <div id ="root"></div>
    <script>
    var firebaseConfig = {
        apiKey: "AIzaSyBQZNSXZK1EVIoez75smdeqEgS3yu3rwi0",
        authDomain: "noteify-d7193.firebaseapp.com",
        databaseURL: "https://noteify-d7193-default-rtdb.firebaseio.com",
        projectId: "noteify-d7193",
        storageBucket: "noteify-d7193.appspot.com",
        messagingSenderId: "259103554370",
        appId: "1:259103554370:web:bb31e247835601343266db",
        measurementId: "G-DXJET6RER1"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
var firebaseRef = firebase.database().ref("uk8FjYIV53Y8huMN7huGMhb7kGA2")
firebaseRef.on("value", function(snapshot) {
    snapshot.forEach(function(element) {
        document.querySelector('#root').innerHTML +=
        <div>${element.val()}</div>
    });
})
   

</script>
    </body>

    </html>